# Admin(본사 관리자) 화면 스펙

## TL;DR
- **목적:** 팀 미배정 작업의 즉각적인 처리 및 전체 작업 프로세스 모니터링/컨트롤
- **핵심 화면:** A-02(작업 목록), A-04(작업 상세)
> 확장(Gate 2 후보, 내부적으로 Phase 1.5로 관리): 상품 카탈로그(분류/상품) 관리 및 WorkOrder 상품 선택 UI 연계를 추가한다. 가격/재고/발주 기능은 본 단계 범위에서 제외한다.
---

## 📋 A-02 작업 목록 (팀 배정 중심)

### 1. 화면 개요
본사 관리자가 미배정 작업을 확인하고 즉시 팀을 배정하는 최상위 관리 화면입니다.

### 2. 주요 기능 및 UI 요소
| 구분 | 상세 내용 | 비고 |
| :--- | :--- | :--- |
| **KPI 카드** | 팀 미배정, 오늘 예정, 진행중, 지연, 완료(오늘) 건수 표시 | 클릭 시 해당 필터 적용 |
| **프리셋 탭** | [팀 미배정] / [오늘] / [지연] / [전체] | 기본 진입: 팀 미배정 |
| **퀵 팀 배정** | 목록 상에서 바로 팀 선택 및 배정 모달 호출 | `assigned_team_id` 없는 경우 노출 |
| **정렬 규칙** | 미배정(생성 역순), 오늘(일정 순), 지연(지연 시간 순) | - |

### 3. 퀵 팀 배정 플로우
1. [팀 배정] 버튼 클릭 ➔ 2. 팀 선택 드롭다운 및 메모(선택) 입력 ➔ 3. [배정하기] 클릭 ➔ 4. 성공 토스트 및 리스트 갱신

---

## 🔍 A-04 작업 상세 (컨트롤 타워)

### 1. 화면 개요
작업 생성부터 완료/발송까지의 모든 이력을 확인하고, 예외 상황(취소, 재발송)을 제어하는 화면입니다.

### 2. 섹션별 상세 스펙
| 섹션 | 주요 내용 | 권한 및 정책 |
| :--- | :--- | :--- |
| **상단 헤더** | 작업 ID, 유형 연동, 상태 배지, 관리 메뉴(⋮) | 취소, 재발송 메뉴 포함 |
| **요약 카드** | 고객사, 현장 주소, 연락처, 일정, 우선순위 | 전화/지도 연동 |
| **배정 컨트롤** | 배정된 팀 확인 및 변경 기능 | 팀 변경 시 사유 입력 필수 |
| **작업 내용** | 요약, 상세 설명, 방문 일정 수정 | `IN_PROGRESS` 이후 수정 제한 |
| **증빙/상태판** | 체크리스트, 서명, 사진, PDF, 발송 상태 | ✅/⚠️ 아이콘으로 직관적 표시 |
| **히스토리** | 시간순 Audit Log (생성~배정~진행~완료) | 최근 10-50개 요약 표시 |
| **상품 정보(확장)** | WorkOrder에 선택된 설치 상품(상품명/모델명/이미지 요약) 표시 | 읽기 중심, 수정은 생성·편집 단계에서 수행 |


### 3. 주요 액션 정책
- **취소 (Cancel):** Admin만 가능, 사유 입력 필수, `COMPLETED` 상태는 취소 불가.
- **재발송 (Resend):** 문자/이메일 개별 선택 가능, 관리자 상세 화면에서만 제공.
- **팀 변경:** 배정된 팀을 바꿀 경우 기록을 위해 변경 사유 입력을 강제함.

---

## 🛠️ UI 텍스트 목업 (Mockup Text)

### [A-02 목록 화면]
- **KPI:** `팀 미배정 4`, `오늘 예정 12`, `지연 2`
- **목록 행:** `[상태: 팀 미배정] | [타입: 설치] | [일정: 14:00] | OO마트 | 액션: [팀 배정]`
- **모달:** `제목: 팀 배정`, `[팀을 선택해주세요 ▾]`, `[배정하기]`

### [A-04 상세 화면]
- **헤더:** `#WO-1042 [설치] 진행중`
- **상태판:** 
  - `체크리스트: 완료 ✅`
  - `서명: 미완료 ⚠️`
  - `문서(PDF): 문서 준비됨 ✅ [다운로드]`
  - `발송(문자): 실패 ⚠️ [재발송]`

### [A-04 상세 화면 확장]
- **[A-05 상품 확장] 설치 상품:** 스페이스 토네이도 (LAS-300K)

### [A-05 상품 분류 관리]
- **상품 분류 목록:** `공간살균기`, `방역 물품` (예시)
- **액션:** [분류 추가] [수정] [비활성화]

### [A-06 상품 관리]
- **검색:** [분류 ▾] [상품명 검색]
- **목록 행:** [공간살균기] 스페이스 토네이도 | LAS-300K | 상태: ACTIVE
- **액션:** [상품 추가] [수정] [비활성화]
---

## 확장(Gate 2 후보) — 상품 카탈로그 관리 (A-05 / A-06)

### A-05 상품 분류 관리 (Admin)
- **목적:** 상품 분류(Category) 등록/수정/비활성화
- **핵심 기능:**
   - 분류 목록 조회
   - 분류 생성/수정
   - 분류 비활성화(삭제 대신)
- **정책:**
   - 비활성 분류는 신규 상품 등록 시 선택 불가
   - 기존 WorkOrder 이력은 유지

### A-06 상품 관리 (Admin)
- **목적:** WorkOrder에서 선택 가능한 설치 상품 마스터 관리
- **기능:** 목록(필터), 생성, 수정, 비활성화
- **필드(최소):** 분류, 상품명, 모델명(선택), 이미지(선택), 설명(선택), 상태
- **정책:** 가격/재고/발주 제외, 비활성 상품은 신규 선택 목록 제외(Phase 2 이후)

### A-04 연계 메모 (중요)
- WorkOrder 생성/상세 화면과 연계
- 상세는 조회 중심, 마스터 수정은 A-05/A-06에서 수행

---

## 📂 연관 API 리스트
- `GET /api/admin/workorders` (목록/KPI 연동)
- `POST /api/workorders/{id}/assign-team` (팀 배정/변경)
- `POST /api/workorders/{id}/cancel` (작업 취소)
- `POST /api/workorders/{id}/resend` (문자/이메일 재발송)
- `GET /api/workorders/{id}/pdf` (PDF 다운로드)
- `(확장/Gate 2 후보) GET /api/admin/product-categories`
- `(확장/Gate 2 후보) POST /api/admin/product-categories`
- `(확장/Gate 2 후보) PATCH /api/admin/product-categories/{id}`
- `(확장/Gate 2 후보) GET /api/admin/products`
- `(확장/Gate 2 후보) POST /api/admin/products`
- `(확장/Gate 2 후보) PATCH /api/admin/products/{id}`

> - 가격/재고 관련 api는 본 단계 범위에서 제외

---

## 연관 문서
- [화면 지도](01-screen-map.md)
- [데이터 스코프 규칙](00-rbac.md#8-데이터-스코프-규칙가장-중요-문서에-박아두기)
- [상품 카탈로그 정책 (Gate 2 후보)](../10-domain/06-product-catalog-policy.md)

## 변경 이력
- **v0.2:** Admin 상품 카탈로그 확장(Gate 2 후보) 메모 및 A-05/A-06 개요 추가 (2026-02-24)
- **v0.1:** 통합문서 기반 초안 정리 (2025-02-20)
