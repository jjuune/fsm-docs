# 沅뚰븳 留ㅽ듃由?뒪(RBAC)

## TL;DR
- ?붾㈃/?됱쐞 ?⑥쐞 沅뚰븳怨?API ?덈꺼 沅뚰븳??遺꾨━???뺤쓽?⑸땲??

## 蹂몃Ц
紐⑺몴???쒖슫???쇱꽑 諛⑹? + 梨낆엫?뚯옱 紐낇솗?붴앸씪?? Admin? 而⑦듃濡?媛먯궗, Team Manager??諛곗젙/愿由? Technician? ?섑뻾/利앸튃?쇰줈 ???섎댋??

**?쒓린:**
- ???덉슜
- ?좑툘 ?쒗븳/議곌굔遺(?ъ쑀 ?꾩슂, ?곹깭 ?쒗븳 ??
- ??遺덇?

---

### [Phase 1 沅뚰븳 留ㅽ듃由?뒪 (RBAC)]

#### 1) ?몄쬆/怨꾩젙
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| 濡쒓렇??濡쒓렇?꾩썐 | ??| ??| ??|
| ???뺣낫 議고쉶 | ??| ??| ??|
| ???뺣낫 ?섏젙(?대찓???꾪솕) | ?좑툘 (?뺤콉) | ?좑툘 (?뺤콉) | ?좑툘 (?뺤콉) |
| 鍮꾨?踰덊샇 蹂寃??ъ꽕??| ??| ??| ??|
| ?ъ슜???앹꽦/鍮꾪솢?깊솕 | ??| ??| ??|
| ??븷 蹂寃?ADMIN/TEAM/TECH) | ??| ??| ??|
| ? ?앹꽦/?섏젙/鍮꾪솢?깊솕 | ??| ??| ??|
| ?ъ슜??? ?곌껐 蹂寃?| ??| ??| ??|

> Phase 1?먯꽌???쒖궗?⑹옄 ?꾨줈???섏젙?앹? ?쇱꽑??留롮븘??珥덇린???쒗븳 異붿쿇(?꾩슂 ??Admin留??섏젙).

#### 2) 怨좉컼/?꾩옣(Customer/Site)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| 怨좉컼 紐⑸줉/?곸꽭 議고쉶 | ??| ?좑툘 (? ?묒뾽 愿?⑤쭔) | ?좑툘 (蹂몄씤 ?묒뾽 愿?⑤쭔) |
| 怨좉컼 ?앹꽦/?섏젙 | ??| ??(?먮뒗 ?좑툘) | ??|
| ?꾩옣 紐⑸줉/?곸꽭 議고쉶 | ??| ?좑툘 (? ?묒뾽 愿?⑤쭔) | ?좑툘 (蹂몄씤 ?묒뾽 愿?⑤쭔) |
| ?꾩옣 ?앹꽦/?섏젙 | ??| ??(?먮뒗 ?좑툘) | ??|

**異붿쿇 ?댁쁺:**
- 怨좉컼/?꾩옣? ?쒕쭏?ㅽ꽣 ?곗씠?겸앸줈 蹂닿퀬 Admin留??섏젙???덉젙??
- ?꾩옣 ?곕씫泥섍? ?먯＜ 諛붾뚮㈃ Team Manager?먭쾶 ?섏젙 沅뚰븳???좑툘濡??댁뼱????蹂寃?濡쒓렇 ?꾩닔).

#### 3) WorkOrder ?앹꽦/?섏젙/議고쉶 (?듭떖)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| ?묒뾽 紐⑸줉 議고쉶 | ??(?꾩껜) | ??(? 踰붿쐞) | ??(蹂몄씤 諛곗젙) |
| ?묒뾽 ?곸꽭 議고쉶 | ??(?꾩껜) | ??(? 踰붿쐞) | ??(蹂몄씤 諛곗젙) |
| ?묒뾽 ?앹꽦(?ㅼ튂/AS) | ??| ?좑툘 (?뺤콉: ?덉슜 ??? 踰붿쐞留? | ??|
| ?묒뾽 ?댁슜 ?섏젙(summary/description) | ?좑툘 (DRAFT~TEAM_ASSIGNED) | ??| ??|
| ?묒뾽 ?쇱젙 ?섏젙 | ?좑툘 (DRAFT~TECH_ASSIGNED) | ?좑툘 (TEAM_ASSIGNED~TECH_ASSIGNED) | ??|
| ?곗꽑?쒖쐞 蹂寃?| ?좑툘 (DRAFT~TECH_ASSIGNED) | ??| ??|
| ?묒뾽 ???蹂寃?INSTALL/AS) | ?좑툘 (DRAFT留? | ??| ??|
| ?묒뾽 痍⑥냼(CANCELLED) | ??(?ъ쑀 ?꾩닔) | ?좑툘 (?뺤콉: TEAM_ASSIGNED源뚯?留?+ ?ъ쑀) | ??|

**媛뺣젰 異붿쿇:**
- ?댁슜/?쇱젙/???蹂寃쎌? ?쒖셿猷???遺꾩웳?앹쓣 遺瑜대?濡??곹깭 ?쒗븳??臾몄꽌??紐낆떆.

#### 4) 諛곗젙(蹂몄궗?믫??믨린?? (Phase 1 ?듭떖 泥댁씤)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| ? 諛곗젙(assigned_team_id) | ??| ??| ??|
| ? 蹂寃?| ?좑툘 (IN_PROGRESS ?댄썑 ?쒗븳 + ?ъ쑀) | ??| ??|
| 湲곗궗 諛곗젙(assigned_technician_id) | ??湲곕낯) / ?좑툘(?덉쇅) | ??| ??|
| 湲곗궗 ?щ같??| ??湲곕낯) / ?좑툘(?덉쇅) | ?좑툘 (IN_PROGRESS ?쒗븳 + ?ъ쑀) | ??|

> Admin??湲곗궗源뚯? 諛곗젙?섎㈃ ?댁쁺 泥닿퀎媛 瑗ъ씠湲??ъ썙??湲곕낯? 湲덉?媛 ?덉젙?? ?쒓릿湲?紐⑤뱶?앷? ?꾩슂?섎㈃ ?덉쇅 沅뚰븳(?좑툘)濡쒕쭔.

#### 5) ?묒뾽 ?섑뻾/利앸튃(湲곗궗 ?곸뿭)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| ?묒뾽 ?쒖옉(IN_PROGRESS) | ??| ??| ?좑툘 (TECH_ASSIGNED?먯꽌留? |
| 泥댄겕由ъ뒪???낅젰/?섏젙 | ??| ??| ?좑툘 (?꾨즺 ?꾧퉴吏留? |
| FAIL 硫붾え ?낅젰 | ??| ??| ??(FAIL ???꾩닔) |
| ?ъ쭊 ?낅줈????젣 | ??| ??| ?좑툘 (?꾨즺 ?꾧퉴吏留? |
| ?쒕챸 ?낅젰/???| ??| ??| ??(?꾩닔) |
| ?꾨즺 ?쒖텧(COMPLETED) | ??| ??| ??(寃利??듦낵 ?? |

**蹂댁“ 沅뚰븳(?쎄린):**
- Admin/Team Manager??泥댄겕由ъ뒪???ъ쭊/?쒕챸 議고쉶留???
#### 6) 臾몄꽌(PDF) / 諛쒖넚(SMS/Email)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| PDF ?앹꽦(?몃━嫄? | ?쒖뒪???먮룞) | ?쒖뒪??| ?쒖뒪??|
| PDF ?ㅼ슫濡쒕뱶/?대엺 | ??| ??(? 踰붿쐞) | ?좑툘 (蹂몄씤 ?묒뾽, ?쎄린) |
| 怨좉컼 諛쒖넚 ?ㅼ젙(踰덊샇/?대찓???듭뀡) | ??| ?좑툘 (?뺤콉) | ?좑툘 (?뺤콉) |
| 怨좉컼 諛쒖넚 ?ㅽ뻾(?먮룞) | ?쒖뒪??| ?쒖뒪??| ?쒖뒪??|
| ?щ컻??臾몄옄/?대찓?? | ??| ?좑툘 (?뺤콉: ? 踰붿쐞留? | ??|
| 諛쒖넚 ?ㅽ뙣 ?먯씤 ?뺤씤 | ??| ?좑툘 (? 踰붿쐞) | ?좑툘 (媛꾨떒 ?곹깭留? |

**異붿쿇:**
- 諛쒖넚 ?듭뀡(踰덊샇/?대찓??? ?쒗쁽???ㅼ닔?앸? 留됯린 ?꾪빐 珥덇린??Admin???명똿?섍퀬, ?꾩옣?먯꽑 ?쎄린留??섎뒗 寃껊룄 ?덉젙??

#### 7) ?대젰/媛먯궗(AuditLog)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| AuditLog 議고쉶(?꾩껜) | ??| ?좑툘 (? 踰붿쐞) | ??|
| ?묒뾽 ?⑥쐞 ?덉뒪?좊━(?붿빟) | ??| ??(? 踰붿쐞) | ?좑툘 (蹂몄씤 ?묒뾽 濡쒓렇) |

> AuditLog ?꾩껜 ?몄텧? Phase 2 ?댄썑. Phase 1? ?묒뾽 ?⑥쐞 ?붿빟留?

#### 8) ?듦퀎 議고쉶 (Phase 1 異붽?)
| 湲곕뒫 | Admin | Team Manager | Technician |
| :--- | :---: | :---: | :---: |
| ?蹂??댁쁺吏??議고쉶(A-00) | ??(ORG) | ??| ??|
| 湲곗궗蹂??댁쁺吏??議고쉶(T-00) | ??(ORG) | ??(TEAM) | ??|
| Admin ??쒕낫???듦퀎 API | ??(ORG) | ??| ??|
| TM ??쒕낫???듦퀎 API | ??(ORG) | ??(TEAM) | ??|

> **?듦퀎??"?댁쁺吏??MVP)"** ?섎???肉? ?깃낵?됯? ?⑸룄濡??ъ슜?섏? ?딆뒿?덈떎.

---

### [Phase 1 API 沅뚰븳/?곹깭 媛??洹쒖튃??

**?쒓린:**
- **Roles:** A(Admin) / TM(Team Manager) / T(Technician)
- **Scope:** ORG(?꾩껜) / TEAM(???) / SELF(??

#### 1) Auth / User / Team
| Endpoint | ?덉슜 Role | Scope | 鍮꾧퀬 |
| :--- | :---: | :---: | :--- |
| POST /auth/login | A/TM/T | - | 濡쒓렇??(inactive 李⑤떒) |
| POST /auth/logout | A/TM/T | - | 濡쒓렇?꾩썐 |
| GET /me | A/TM/T | SELF | ???뺣낫(role/team_id ?ы븿) |
| PATCH /me | ?좑툘 | SELF | Phase 1 ?쒗븳 沅뚯옣 |
| GET /admin/teams | A | ORG | ? 紐⑸줉 |
| POST /admin/teams | A | ORG | ? ?앹꽦 (name immutable) |
| PATCH /admin/teams/{id} | A | ORG | ? ?섏젙 (**name ?쒖쇅**) |
| PATCH /admin/teams/{id}/deactivate | A | ORG | ? 鍮꾪솢?깊솕 (??젣 湲덉?) |
| GET /admin/teams/{id}/stats | A | ORG | ? ?댁쁺吏??|
| GET /admin/stats/teams | A | ORG | ?꾩껜 ? ?붿빟(??쒕낫?? |
| GET /team/technicians | TM | TEAM | 湲곗궗 紐⑸줉 |
| POST /team/technicians | TM | TEAM | 湲곗궗 珥덈? (role=TECH 怨좎젙) |
| PATCH /team/technicians/{id} | TM | TEAM | 湲곗궗 ?뺣낫 ?섏젙 |
| PATCH /team/technicians/{id}/deactivate | TM | TEAM | 湲곗궗 鍮꾪솢?깊솕 (??젣 湲덉?) |
| GET /team/stats/technicians | TM | TEAM | 湲곗궗蹂??댁쁺吏??|

#### 2) Customer / Site (留덉뒪???곗씠??
| Endpoint | ?덉슜 Role | Scope | 鍮꾧퀬 |
| :--- | :---: | :---: | :--- |
| GET /customers | A | ORG | ?꾩껜 怨좉컼 |
| POST /customers | A | ORG | 怨좉컼 ?앹꽦 |
| PATCH /customers/{id} | A | ORG | 怨좉컼 ?섏젙 |
| POST /sites | A | ORG | ?꾩옣 ?앹꽦 |

#### 3) WorkOrder 紐⑸줉/?곸꽭
| Endpoint | ?덉슜 Role | Scope | 鍮꾧퀬 |
| :--- | :---: | :---: | :--- |
| GET /admin/workorders | A | ORG | 蹂몄궗 紐⑸줉 |
| GET /teams/{teamId}/workorders | TM | TEAM | ? 紐⑸줉 |
| GET /tech/workorders | T | SELF | 湲곗궗 紐⑸줉 |
| GET /workorders/{id} | A/TM/T | ?ㅼ퐫?꾨퀎 | ?곸꽭 議고쉶 |

---

### [Phase 1 ?쒓텒???뺤콉媛믠?
- 怨좉컼/?꾩옣 留덉뒪???섏젙: **Admin留?*
- 湲곗궗 諛곗젙: **Team Manager留?*
- ? 蹂寃? **Admin留?* (IN_PROGRESS ?댄썑 ?ъ쑀 ?꾩닔)
- ?꾨즺 ?댄썑 ?섏젙: ?듭떖 利앸튃(泥댄겕由ъ뒪???쒕챸/?ъ쭊) **?섏젙 湲덉?**
- ?щ컻?? **Admin 湲곕낯**, Team Manager???꾩슂 ??? 踰붿쐞濡쒕쭔
